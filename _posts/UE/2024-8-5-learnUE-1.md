---
layout: post
title: 进来看我骂UE/UE学习笔记
subtitle: 读取数据文件的地形建模；封面：X：@fleia0124
banner:
  image: /assets/images/banners/13.jpg
  opacity: 0.618
  background: "#000"
  height: "100vh"
  min_height: "38vh"
  heading_style: "font-size: 4.25em; font-weight: bold; text-decoration: underline"
  subheading_style: "color: gold"
tags: UE
published: false
---

## 吐槽

&emsp;&emsp;UE真的是答辩中的答辩，狗食中的狗食！我没想到竟然这么大的引擎文档写成这样！他妈的，我必须历数其罪状！

1. 文档根本不全。里面许多函数节点文档里根本就没有，想查资料都没得查！这个我就不举例了，你蓝图模式右击一下这么多节点，再看看官网有几个函数，是个人都能看出来不全。<br>
2. 文档丝毫不详细。这根本不叫文档，叫新手入门教程！我来看文档是为了看教程来了？堂堂大公司连文档都写不明白？很多功能只是草草放个教程让你跟着做就了事了，见没见过文档？ <br> &emsp;&emsp;我举个例子。我使用创建地形的导入功能，导入之后我发现地形的高度并不是我所期望的，查阅许多资料我才知道，UE会自动放缩到-256~256之间！这样大的改动文档里竟然只字不提！给程序编写造成极大的麻烦！<br> &emsp;&emsp;水体添加也是的，想一想就觉得复杂的东西给他几句话说完了！他根本就没想和你说明白这个东西！
3. 文档许多错误！我看的明明是引擎版本5.4的，竟然还是老版本的教程，里面根本就没这个界面！比如说，文档里说这个按钮在主界面右下角:

![](/assets/images/2024-08-06-18-09-05.png)

实际上界面根本就没有这个按钮，这个按钮移动到哪里去了呢？编辑-编辑器偏好设置-通用-实时代码编写！你改UI我管不着，你文档都不带变的？实际上是在这里：

![](/assets/images/2024-08-06-18-10-31.png)

真是开了眼了，有生之年见到这样的文档！你不全就算了，一点参考价值没有！网页格式也是错的，添个代码片段添不明白：

![](/assets/images/2024-08-06-18-13-38.png)

&emsp;&emsp;这他妈是人干的事？实习生都干不出来吧？根本不是人！

4. 社区基本没有，学习环境极差。这个倒是和UE没直接关系，但你Epic是始作俑者！国内UE方面的课程基本都是机构做的，免费的固然也很多，但是总的来说，社区环境相比其他圈子简直是天壤之别！即使是国内的单片机方面、C/C++方面，也有许多免费的好教程，因为GNU的文档写得好！你不教有的是人教！再不济看文档自学了！单片机卖课的也有，但是网上资料特别多，自学完全没压力！UE的东西，别人不教你根本就别想学！看到你这b文档我就来气！

&emsp;&emsp;骂归骂，项目要用的东西不能不学，即使这是一坨狗式。不过所幸的是项目重点应该是不在UE上，或者说这方面要求的不多。

## 高度图地形导入

&emsp;&emsp;点开地形面板：

![](/assets/images/2024-08-06-18-52-03.png)

点高度图文件旁边的三个点，选择文件。然后注意调整下面缩放里的z轴缩放比例，100会导致你的山特别特别尖。然后分段大小改到最大，255*255。然后点击导入。导入完了可以在右侧大纲里：

![](/assets/images/2024-08-06-18-57-14.png)

修改地形坐标（默认不是0，0，0）；更改地形材质。

## 创建高度相关的材质，以分层设色地形图为例

&emsp;&emsp;首先要知道，导入后你的高度图会被缩放到-256~256之间。然后会根据放大倍数进行扩大。例如，Z轴放大倍数是10的情况下，原本的256会变成2560。我们想要分层设色，那么就需要将目前的海拔归一化：

![](/assets/images/2024-08-06-19-04-27.png)

&emsp;&emsp;首先获取Z轴坐标，然后+2560。为什么加这个？前面说了导入后海拔是-256~256，扩大10倍是-2560~2560.我们要归一化肯定不要负数，所以要+2560。后面有个`Subtract`节点，这个是因为如果你地形坐标系原点不在0，0，0的话你应该减去这个偏置项，这就是前面提到的，可以在大纲里面看地形的位置。然后我们除以缩放因子10，化归0~512.再将其除以512，自然就是归一化了。后面的这个`Saturate`节点是限位节点，将小于0和大于1的值限位到0和1.

&emsp;&emsp;由此，我们得到了某个点的归一化高度，现在需要对其上色。我们希望低海拔是蓝色，中间黄色，最高是红色。怎么做呢？理论上，有一个渐变的表达式是最好的。但是，经过查找文档，我发现UE里好像并没有这样的渐变表达式。所以，我使用了下面的方法，虽然并不是很正确：

![](/assets/images/2024-08-06-23-25-09.png)

&emsp;&emsp;这个图片的输入就是上面的归一化结果。首先，我们的目标是，蓝色在海拔0%~60%递减。那么，我们首先要进行限位：判断当前的海拔是否小于0.6，如果小于，进行下一个环节，否则蓝色的权值直接设为0

&emsp;&emsp;前面说到UE里我没找到渐变的函数，那么我们只能用正比例函数模拟：将当前的归一化海拔（0~0.6）除以0.6，就是当前蓝色通道的权值。。。。吗？别忘了我们希望低海拔是蓝色，而0除以0.6等于0，蓝色权值反而是0了，所以要用1去减。也就是图里所使用的流程。把这个权值乘以蓝色就可以了。

&emsp;&emsp;相似的，可以作出另外三个通道的流程。这里放一个效果图。很丑（这个是做了水下蒙版的，是水下视角，整体特别发蓝）：

![](/assets/images/2024-08-06-23-30-32.png)
